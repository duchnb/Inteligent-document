<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Intelligent Document Engine – Search & Answer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="stylesheet" href="style.css"/>
</head>
<body>
<div class="wrap grid">
    <div class="card stack">
        <h1>Intelligent Document Engine — UI</h1>

        <!-- Hidden by default; shown only when overriding with ?api=... -->
        <div id="apiRow" class="stack" style="display:none">
            <label class="muted" for="apiBase">API Base URL</label>
            <input id="apiBase" type="text" placeholder="https://<api-id>.execute-api.eu-west-2.amazonaws.com"/>
        </div>

        <label class="muted">Upload PDF</label>
        <input class="upload-btn" id="file" type="file" accept=".pdf,.png,.jpg,.jpeg"/>
        <div class="btnbar">
            <button onclick="doUpload()">Upload</button>
        </div>

        <label class="muted">Query</label>
        <textarea id="query" placeholder='e.g. "How can I thicken a thin curry sauce?"'></textarea>

        <div class="row">
            <div class="stack">
                <label class="muted">Top-K</label>
                <div class="row-between muted" aria-hidden="true">
                    <span>Deterministic, focused output (Top-K = 1)</span>
                    <span>More variability and novelty (Top-K = 10)</span>
                </div>
                <input id="topk" type="range" min="1" max="10" step="1" value="5"
                       aria-label="Top-K: controls result diversity from deterministic (1) to novel (10)"/>
                <div class="muted" style="font-size:12px">Current Top-K: <span id="topkVal">5</span></div>
                <div class="btnbar">
                    <button class="primary" onclick="doAnswer()">Answer</button>
                    <button onclick="doSearch()">Search</button>
                    <button onclick="clearOut()">Clear</button>
                </div>
            </div>
            <div class="stack">
                <label class="muted">Quick tips</label>
                <div class="result">
                    <div class="kvs">
                        <div>Status</div>
                        <div id="status" class="ok">Ready</div>
                        <div>CORS</div>
                        <div>This UI calls same-origin paths (<code>/answer</code>, <code>/search</code>, <code>/upload</code>) via CloudFront.</div>
                        <div>Note</div>
                        <div>Results show S3 URIs as citations; they aren’t public links (by design).</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="out" class="grid"></div>
</div>

<!-- Busy overlay -->
<div id="busy-layer" aria-hidden="true">
  <div class="busy-panel" role="status" aria-live="polite">
    <div class="spinner" aria-hidden="true"></div>
    <div class="label">Working…</div>
  </div>
</div>

<!-- Load libs BEFORE main script -->
<script src="vendor/marked.min.js" defer></script>
<script src="vendor/purify.min.js" defer></script>
<script src="app.js" defer></script>
</body>
</html>
